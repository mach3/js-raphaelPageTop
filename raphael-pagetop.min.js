/*!
 * RaphaelPagetop
 * @author mach3
 * @version 1.0
 * @requires jQuery.js, Raphael.js
 * @example
 *
 *   // Simple Example
 *   $("#myElement").addPagetop(); // Attach the button to the element.
 *   $("#myElement").removePagetop(); // Remove it.
 *
 *   // Example with option
 *   $("#myElement").addPagetop( {
 *     path : "....", // SVG Path expression as string
 *     width : 32, // Button width as integer
 *     height : 32, // Button height as integer
 *     color : "#222", // Button fill color for default as string
 *     hoverColor : "#c90", // Button fill color for hover state as string
 *     marginBottom : 20 // Pixel size of margin bottom as number
 *   } );
 *
 */
(function(a,c){var b=function(e){var f,d;f=this;d={};f.option={container:null,path:"M0,4V28Q0,32,4,32H32V0H4Q0,0,0,4zM22,22L16,16l-6,6L6,19l6-6L16,9l3,3L26,19L22,22z",width:32,height:32,color:"#222",hoverColor:"#c90",marginBottom:20,id:"raphael-page-top"};d.vars={visible:false};f.container=null;f.buttonContainer=null;f.button=null;d.config=function(h){var g;for(g in h){if(f.option.hasOwnProperty(g)){f.option[g]=h[g]}}};f.init=function(g){if(g){d.config(g)}f.container=f.option.container;f.buttonContainer=d.getButtonContainer();f.button=d.getButtonElement();a(window).bind("scroll",f.update);f.update();return f};d.getButtonContainer=function(){return a("<div>").attr({id:f.option.id}).css({position:"absolute",overflow:"hidden",top:-(f.option.height),right:0,width:f.option.width,height:f.option.height}).prependTo(a("body"))};d.getButtonElement=function(){var j,k,g,h,i;j=Raphael(f.option.id,f.option.width,f.option.height);k=j.set();g=j.path(f.option.path).attr({stroke:"none",fill:f.option.color});h=j.rect(0,0,f.option.width,f.option.height).attr({fill:"#fff",opacity:0,cursor:"hand"});k.push(g,h);k.hover(function(){d.changeFillColor(g,f.option.hoverColor)},function(){d.changeFillColor(g,f.option.color)});k.click(function(){a("html,body").animate({scrollTop:0});d.changeFillColor(g,f.option.color)});i="t{{x}},0".replace("{{x}}",f.option.width);k.transform(i);k.hide=function(){this.animate({transform:i},300,"bounce");return this};k.show=function(){this.animate({transform:"t0,0"},300,"bounce");return this};return k};d.changeFillColor=function(h,g){h.animate({fill:g},300,"linear")};f.update=function(){var h,i,g,j;h=f.container;i=f.option;g=a(document).scrollTop();j=Math.min((h.height()+h.offset().top-i.height),(g+a("html").prop("clientHeight")-i.marginBottom-i.height));f.buttonContainer.stop().animate({top:j},500,function(){var k=g>0;if(k!==d.vars.visible){f.setVisible(k)}});return f};f.setVisible=function(g){d.vars.visible=g;if(g){f.button.show()}else{f.button.hide()}return f};f.destroy=function(){f.buttonContainer.remove();a(window).unbind("scroll",f.update)};f.init(e)};a.fn.extend({addPagetop:function(d){this.each(function(){var f,e;f=a(this);e=new b(a.extend(d,{container:f}));f.data("raphaelPagetop",e)});return this},removePagetop:function(){var d=a(this).data("raphaelPagetop");if(d){d.destroy()}return this}})})(jQuery);